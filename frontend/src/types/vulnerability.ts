export type VulnerabilityType = 'LFI' | 'RCE' | 'SSRF' | 'AFO' | 'SQLI' | 'XSS' | 'IDOR'

export interface ContextCode {
  name: string
  reason: string
  code_line: string
}

export interface VulnerabilityFinding {
  scratchpad: string
  analysis: string
  poc: string
  confidence_score: number
  vulnerability_types: VulnerabilityType[]
  context_code: ContextCode[]
}

export interface FileAnalysis {
  file_path: string
  findings: VulnerabilityFinding[]
}

export interface VulnerabilityResult {
  project_name: string
  analysis_date: string
  total_files_analyzed: number
  total_vulnerabilities: number
  high_confidence_vulnerabilities: number
  file_analyses: FileAnalysis[]
  summary: {
    vulnerability_counts: Record<VulnerabilityType, number>
    average_confidence: number
    most_critical_file: string | null
  }
}

export interface AnalysisRequest {
  files: File[]
  llm_choice: 'gpt' | 'claude' | 'ollama'
  specific_file?: string
  verbose?: boolean
}
